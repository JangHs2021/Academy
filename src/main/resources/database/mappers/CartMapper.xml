<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.ac.home.cart.CartDAO">
  
  	<select id="findCartGoods" resultType="String" parameterType="CartDTO">
		SELECT DECODE(COUNT(*), 0, 'false', 'true') FROM CART
		WHERE NUM = #{num}
		AND ID = #{id} 
	</select>

	<insert id="addGoodsInCart">
		INSERT INTO CART (CARTNUM, ID, NUM) 
		VALUES (SELECT NVL2(MAX(CARTNUM), MAX(CARTNUM)+1, 1) FROM CART , #{id}, #{num})
		<selectKey keyProperty="cartNum" resultType="Long" order="AFTER">
			SELECT MAX(CARTNUM) FROM CARTNUM
		</selectKey>
	</insert>
  
  </mapper>